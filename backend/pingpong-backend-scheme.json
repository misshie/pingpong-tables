{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "piNGPong tables API Response",
  "description": "Schema for the JSON response from the /api/predict endpoint.",
  "type": "object",
  "properties": {
    "model_version": {
      "type": "string",
      "description": "Version of the GestaltMatcher model used."
    },
    "gallery_version": {
      "type": "string",
      "description": "Version of the gallery data used."
    },
    "suggested_genes_list": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/geneEntry"
      }
    },
    "suggested_syndromes_list": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/syndromeEntry"
      }
    },
    "suggested_patients_list": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/patientEntry"
      }
    },
    "queried_hpo_ids": {
      "type": "array",
      "description": "The list of HPO IDs used in the query, if provided.",
      "items": {
        "type": "string",
        "pattern": "^HP:[0-9]{7}$"
      }
    },
    "pubcasefinder": {
      "$ref": "#/$defs/pubCaseFinderResult"
    }
  },
  "required": [
    "model_version",
    "gallery_version",
    "suggested_genes_list",
    "suggested_syndromes_list",
    "suggested_patients_list"
  ],
  "$defs": {
    "geneEntry": {
      "type": "object",
      "properties": {
        "gene_name": { "type": "string" },
        "gene_entrez_id": { "type": "string" },
        "distance": { "type": "number" },
        "score": { "type": ["number", "null"] },
        "gm_rank": { "type": "integer" },
        "pubcasefinder_rank": { "type": ["integer", "null"] },
        "pubcasefinder_score": { "type": ["number", "null"] },
        "mean_rank": { "type": ["number", "null"] },
        "meta_rank": { "type": "integer" }
      },
      "required": ["gene_name", "gene_entrez_id", "distance", "score", "gm_rank", "meta_rank"]
    },
    "syndromeEntry": {
      "type": "object",
      "properties": {
        "syndrome_name": { "type": "string" },
        "omim_id": { "type": "integer" },
        "distance": { "type": "number" },
        "image_id": { "type": "string" },
        "subject_id": { "type": "string" },
        "score": { "type": ["number", "null"] },
        "gm_rank": { "type": "integer" },
        "pubcasefinder_rank": { "type": ["integer", "null"] },
        "pubcasefinder_score": { "type": ["number", "null"] },
        "mean_rank": { "type": ["number", "null"] },
        "meta_rank": { "type": "integer" }
      },
      "required": ["syndrome_name", "omim_id", "distance", "image_id", "subject_id", "score", "gm_rank", "meta_rank"]
    },
    "patientEntry": {
      "type": "object",
      "properties": {
        "subject_id": { "type": "string" },
        "gene_name": { "type": "string" },
        "gene_entrez_id": { "type": "string" },
        "distance": { "type": "number" },
        "image_id": { "type": "string" },
        "syndrome_name": { "type": "string" },
        "omim_id": { "type": ["integer", "string"] },
        "score": { "type": ["number", "null"] },
        "gm_rank": { "type": "integer" },
        "pubcasefinder_rank": { "type": ["integer", "null"] },
        "pubcasefinder_score": { "type": ["number", "null"] },
        "mean_rank": { "type": ["number", "null"] },
        "meta_rank": { "type": "integer" },
        "numeric_omim_id": { "type": ["integer", "null"] },
        "phenotypic_series_id": { "type": ["string", "null"] }
      },
      "required": ["subject_id", "gene_name", "gene_entrez_id", "distance", "image_id", "syndrome_name", "omim_id", "score", "gm_rank", "meta_rank"]
    },
    "pubCaseFinderResult": {
      "type": "object",
      "properties": {
        "ranked_list": {
          "type": "array",
          "items": { "$ref": "#/$defs/pcfRankedListItem" }
        },
        "hpo_names": {
          "type": "object",
          "additionalProperties": { "$ref": "#/$defs/hpoNameEntry" }
        }
      },
      "required": ["ranked_list", "hpo_names"]
    },
    "pcfRankedListItem": {
      "type": "object",
      "description": "NOTE: This schema is based on the assumed structure used by the integrator. It may not be exhaustive.",
      "properties": {
        "id": { "type": "string" },
        "rank": { "type": "integer" },
        "score": { "type": "number" },
        "hgnc_gene_symbol": { "type": "array", "items": { "type": "string" } },
        "omim_disease_name_en": { "type": "string" }
      }
    },
    "hpoNameEntry": {
      "type": "object",
      "properties": {
        "name_en": { "type": "string" },
        "name_ja": { "type": "string" }
      },
      "required": ["name_en", "name_ja"]
    }
  }
}
